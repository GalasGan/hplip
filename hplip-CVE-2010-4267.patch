diff -up hplip-3.9.8/io/hpmud/pml.c.CVE-2010-4267 hplip-3.9.8/io/hpmud/pml.c
--- hplip-3.9.8/io/hpmud/pml.c.CVE-2010-4267	2009-08-04 22:37:25.000000000 +0100
+++ hplip-3.9.8/io/hpmud/pml.c	2010-12-17 17:27:27.722780045 +0000
@@ -504,6 +504,8 @@ enum HPMUD_RESULT hpmud_get_pml(HPMUD_DE
       p += 2;                               /* eat type and length */
    }
    
+   if (dLen > buf_size)
+      dLen = buf_size;
    memcpy(buf, p, dLen);
    *bytes_read = dLen; 
    *type = dt;
